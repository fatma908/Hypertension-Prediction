# -*- coding: utf-8 -*-
"""Hypertension.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1bxVHxCrdZ9CJ4NxWZESOScERI2FZAWqO
"""

import pandas as pd
import numpy as np
from sklearn.preprocessing import LabelEncoder, StandardScaler

df = pd.read_csv("/content/hypertension_dataset 2.csv")

print("Initial shape:", df.shape)
print("\nFirst 5 rows:")
print(df.head())

df.columns = (
    df.columns.str.strip()
             .str.lower()
             .str.replace(" ", "_")
             .str.replace("-", "_")
)

print("\nCleaned columns:", df.columns.tolist())

print("\nMissing values per column:\n", df.isnull().sum())

for col in df.columns:
    if df[col].dtype in ["int64", "float64"]:
        df[col].fillna(df[col].median(), inplace=True)
    else:
        df[col].fillna(df[col].mode()[0], inplace=True)

print("\nMissing values after cleaning:\n", df.isnull().sum())

categorical_cols = df.select_dtypes(include=["object", "category"]).columns
print("\nCategorical columns:", categorical_cols.tolist())

le = LabelEncoder()
for col in categorical_cols:
    df[col] = le.fit_transform(df[col].astype(str))

numeric_cols = df.select_dtypes(include=["int64", "float64"]).columns

for col in numeric_cols:
    q1 = df[col].quantile(0.25)
    q3 = df[col].quantile(0.75)
    iqr = q3 - q1
    lower, upper = q1 - 1.5 * iqr, q3 + 1.5 * iqr
    df[col] = np.where(df[col] < lower, lower,
              np.where(df[col] > upper, upper, df[col]))

scaler = StandardScaler()
df[numeric_cols] = scaler.fit_transform(df[numeric_cols])

print("\nFinal shape:", df.shape)
print("\nDataset sample after cleaning:\n", df.head())